<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anna Ramji">
<meta name="dcterms.date" content="2023-12-17">
<meta name="description" content="Statistical analysis and data visualization of CA Spiny Lobster data from 5 Santa Barbara Coastal LTER Reef sites">

<title>Anna Ramji - California Spiny Lobsters &amp; Reef Bottom Temperatures</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Anna Ramji</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html" rel="" target="">
 <span class="menu-text">Projects + Blog</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">California Spiny Lobsters &amp; Reef Bottom Temperatures</h1>
                  <div>
        <div class="description">
          Statistical analysis and data visualization of CA Spiny Lobster data from 5 Santa Barbara Coastal LTER Reef sites
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Quarto</div>
                <div class="quarto-category">MEDS</div>
                <div class="quarto-category">Stats</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">Portfolio</div>
                <div class="quarto-category">Marine</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://annaramji.github.io/">Anna Ramji</a> <a href="https://orcid.org/https://orcid.org/0009-0006-7576-7793" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
      <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://bren.ucsb.edu/about">
              MEDS
              </a>
            </p>
        </div>
      </div>

  <div class="quarto-title-meta">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 17, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#california-spiny-lobsters-reef-bottom-temperatures-in-santa-barbara-coastal-lter-reef-sites" id="toc-california-spiny-lobsters-reef-bottom-temperatures-in-santa-barbara-coastal-lter-reef-sites" class="nav-link active" data-scroll-target="#california-spiny-lobsters-reef-bottom-temperatures-in-santa-barbara-coastal-lter-reef-sites">California Spiny Lobsters &amp; Reef Bottom Temperatures in Santa Barbara Coastal LTER Reef Sites</a>
  <ul class="collapse">
  <li><a href="#introduction-background" id="toc-introduction-background" class="nav-link" data-scroll-target="#introduction-background">Introduction &amp; Background</a>
  <ul class="collapse">
  <li><a href="#sbc-lter-long-term-kelp-forest-study-sites" id="toc-sbc-lter-long-term-kelp-forest-study-sites" class="nav-link" data-scroll-target="#sbc-lter-long-term-kelp-forest-study-sites">SBC LTER: long term kelp forest study sites</a></li>
  </ul></li>
  <li><a href="#about-the-data" id="toc-about-the-data" class="nav-link" data-scroll-target="#about-the-data">About the Data</a>
  <ul class="collapse">
  <li><a href="#dataset-1-sbc-lter-reef-california-spiny-lobster-data" id="toc-dataset-1-sbc-lter-reef-california-spiny-lobster-data" class="nav-link" data-scroll-target="#dataset-1-sbc-lter-reef-california-spiny-lobster-data">Dataset 1: SBC LTER: Reef: California Spiny Lobster Data</a></li>
  <li><a href="#dataset-2-sbc-lter-reef-bottom-temperature-data" id="toc-dataset-2-sbc-lter-reef-bottom-temperature-data" class="nav-link" data-scroll-target="#dataset-2-sbc-lter-reef-bottom-temperature-data">Dataset 2: SBC LTER: Reef: Bottom temperature data</a></li>
  <li><a href="#reading-in-the-data" id="toc-reading-in-the-data" class="nav-link" data-scroll-target="#reading-in-the-data">Reading in the Data</a></li>
  </ul></li>
  <li><a href="#preliminary-plotting-data-exploration" id="toc-preliminary-plotting-data-exploration" class="nav-link" data-scroll-target="#preliminary-plotting-data-exploration">Preliminary plotting, data exploration</a></li>
  <li><a href="#averages" id="toc-averages" class="nav-link" data-scroll-target="#averages">Averages</a>
  <ul class="collapse">
  <li><a href="#making-subsets-taking-names-means" id="toc-making-subsets-taking-names-means" class="nav-link" data-scroll-target="#making-subsets-taking-names-means">Making subsets, taking <del>names</del> means</a></li>
  <li><a href="#average-reef-bottom-temperature-over-time" id="toc-average-reef-bottom-temperature-over-time" class="nav-link" data-scroll-target="#average-reef-bottom-temperature-over-time">Average reef bottom temperature over time</a></li>
  </ul></li>
  <li><a href="#lobster-size-reef-temperature-relationship" id="toc-lobster-size-reef-temperature-relationship" class="nav-link" data-scroll-target="#lobster-size-reef-temperature-relationship">Lobster size &amp; reef temperature relationship</a>
  <ul class="collapse">
  <li><a href="#simple-linear-model-plot" id="toc-simple-linear-model-plot" class="nav-link" data-scroll-target="#simple-linear-model-plot">Simple linear model plot</a></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression">Multiple regression</a></li>
  <li><a href="#multiple-regression-with-interaction" id="toc-multiple-regression-with-interaction" class="nav-link" data-scroll-target="#multiple-regression-with-interaction">Multiple regression with interaction</a></li>
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">Simple linear regression</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#additional-considerations-possible-next-steps" id="toc-additional-considerations-possible-next-steps" class="nav-link" data-scroll-target="#additional-considerations-possible-next-steps">Additional Considerations &amp; Possible Next Steps</a></li>
  <li><a href="#sources" id="toc-sources" class="nav-link" data-scroll-target="#sources">Sources</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">




<section id="california-spiny-lobsters-reef-bottom-temperatures-in-santa-barbara-coastal-lter-reef-sites" class="level1">
<h1>California Spiny Lobsters &amp; Reef Bottom Temperatures in Santa Barbara Coastal LTER Reef Sites</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/CA_Spiny_Lobster.jpg" class="img-fluid figure-img" alt="this image shows two california spiny lobsters under a rock" width="711"></p>
<figcaption class="figure-caption">CA Spiny Lobsters</figcaption>
</figure>
</div>
<p><a href="https://en.wikipedia.org/wiki/California_spiny_lobster#/media/File:California_Spiny_Lobster.jpg">Image credits</a>: By Ed Bierman from CA, USA - Spiny Lobster, CC BY 2.0, <a href="https://commons.wikimedia.org/w/index.php?curid=61489279" class="uri">https://commons.wikimedia.org/w/index.php?curid=61489279</a></p>
<section id="introduction-background" class="level2">
<h2 class="anchored" data-anchor-id="introduction-background">Introduction &amp; Background</h2>
<p>In this project, I work with data from the Santa Barbara Coast LTER sites, analyzing data using statistical analysis methods covered in the Master of Environmental Data Science program’s Environmental Data Science (EDS) 222: Statistics for Environmental Data Science course taught by <a href="https://www.tammacarleton.com/">Tamma Carleton</a>.</p>
<p>I first became interested in lobsters in 2021 during the pandemic, when I, and millions of other lobster laypeople came across a now <a href="https://www.tiktok.com/@jacob__knowles?lang=en">TikTok</a>- and <a href="https://www.youtube.com/@jacobknowles5421">YouTube</a>-famous Maine Lobster fisherman’s videos. In these clips, Jacob Knowles, the current lead of a multi-generational, family-owned lobster fishing operation, candidly portrays what it’s like to be a lobster fisherman in Maine during lobster season. This is a gross generalization, and there are many nuances, including casually disseminated lobster facts and information, special close-ups on rare lobsters (sometimes blue, recently a 1-in-50 million chance <a href="https://www.independent.co.uk/news/world/americas/lobster-half-blue-maine-tiktok-bowie-b2450916.html">half-blue-half-red lobster named Bowie</a>.</p>
<p>I later learned that Maine Lobster fisheries are threatened by climate change, with rising sea temperatures and environmental pressures pushing American Lobster (<em>Homarus americanus</em>) populations farther north or into general decline if not managed appropriately <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a><sup>,</sup> <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a><sup>,</sup> <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Intense warming in waters on the East Coast coupled with failure to act and adapt quickly enough has already led to the collapse of the Gulf of Maine cod fishery <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>.</p>
<p>Lobsters are sensitive to change, and it can impact their behavior<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. Recent studies suggests that changing sea temperatures have implications on the size at which <em>Homarus americanus</em> reach maturity, and bacterial diversity and cultivability <a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a><sup>,</sup> <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. Warming that impacts areas that juvenile lobsters rely on can lead them to become inhospitable, which is particularly dangerous as the Gulf of Maine has been warming at a rate faster than 99% of the world’s oceans <a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a><sup>,</sup> <a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
<p><strong>Given all of this established background and concern over the American Lobsters, as a Santa Barbara resident and lifelong fan of the California coast and all of its marine life, I wondered if the California Spiny Lobster <em>Panulirus interruptus,</em> was facing similar threats.</strong></p>
<p><img src="figs/diver-spiny-lobster.jpeg" class="img-fluid" width="356"></p>
<p>Image credits: <a href="https://www.nps.gov/articles/california-spiny-lobster.htm">Brett Seymour for NPS</a></p>
<p>The species is currently listed as a species of “least concern” on the IUCN Redlist, and their populations have been managed by the California Department of Fish and Wildlife for decades. If you aren’t already convinced, I’m happy to inform you that the CA Spiny Lobster is significant both economically and ecologically. In the 2017-2018 fishing season, the commercial fishery accounted for roughly $12.7 million in ex-vessel value, and the recreational fishery contributes “between $33-40 million in consumer spending to the California economy each year.” <a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
<p>Do you think kelp forests are cool? Well, these lobsters are also a keystone species in California’s kelp forest ecosystems. They’re a key predator of purple sea urchins, which love to eat the Giant Kelp that the rest of the ecosystem depends on. Spiny lobsters relieve this predation (urchin grazing) on Giant Kelp forests and as many larger fish prey on these lobsters, they are a key, mid-trophic level species<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>. They typically forage at night, and according to the CADFW’s Marine Species Portal, “the Spiny lobster provides an important role in the ecology of rocky reefs, and it is associated with critical habitats such as surfgrass beds.” <a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
<p>The Santa Barbara Coast and the Channel Islands National Park are key areas of the California Spiny Lobsters’ habitat:</p>
<p><img src="figs/ca-spiny-lobster-habitat.jpg" class="img-fluid" width="407"></p>
<p>The presence of eelgrass or surfgrass in the rocky reefs in these areas also provide critical habitat for the 11 larval stages of Spiny lobsters.</p>
<p><em>Panulirus interruptus</em> are estimated to reach sexual maturity at around 5-7 years old (Females typically take longer to mature) which is estimated by a carapace length of 2.5 inches, or 63.5 millimeters <a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a>. The CA Department of Fish &amp; Wildlife manages the Spiny Lobster populations in part by restricting the months during which it is legal to hunt/fish for them. The fishing season is from early October to mid-March, which allows populations to recover in the off-season, as this species has a complex reproductive cycle and needs to molt (shed their exoskeleton) which makes them especially vulnerable to predation. The legal catch size is 3.25 inches, or 82.55 millimeters <a href="#fn14" class="footnote-ref" id="fnref14" role="doc-noteref"><sup>14</sup></a>. Overall, it seems that the populations are able to remain stable thanks to the careful management of the CADFW.</p>
<p><img src="figs/ca-spiny-lobster-diagram.jpeg" class="img-fluid" width="576"></p>
<p>This diagram labels key attributes of the California Spiny Lobster, including the area that is measured to obtain the carapace length (CL) measurements used in determining maturity, catch length, and as a proxy for age.</p>
<p>I also became interested in investigating how the 2015/2016 El Niño may have impacted Spiny lobster populations, as it was the most extreme El Niño in the previous 145 years<a href="#fn15" class="footnote-ref" id="fnref15" role="doc-noteref"><sup>15</sup></a>. With the warmer sea surface temperatures associated with El Niño events, would we see populations being impacted on the Santa Barbara Coast?</p>
<section id="sbc-lter-long-term-kelp-forest-study-sites" class="level3">
<h3 class="anchored" data-anchor-id="sbc-lter-long-term-kelp-forest-study-sites">SBC LTER: long term kelp forest study sites</h3>
<p>The Santa Barbara Coastal Long Term Ecological Research project (SBC LTER) has many study sites at which a wide variety of data are collected, from fish abundance and population dynamics to complex water chemistry and temperature data. Using this data and the context given above, I tried to answer the question: <strong>What is the relationship between California Spiny Lobster populations and reef bottom temperatures?</strong></p>
<p>To investigate the relationship between CA Spiny Lobsters populations and reef bottom temperatures, I used <strong>carapace length</strong> as it is the primary size metric for lobsters and is used as a proxy measurement for age, which can help provide information about the population structure at various reef sites. I also used <strong>reef bottom temperatures</strong> (as apposed to sea surface temperatures (SST). All of this data was collected at reef study sites in the SBC LTER network.</p>
<p>The five SBC LTER Reef sites that I’ll be using data from in this analysis are:</p>
<ul>
<li>Arroyo Quemado Reef: site code “<code>AQUE</code>”
<ul>
<li>depth range: 5.4 meters to 10.7 meters</li>
</ul></li>
<li>Naples Reef: site code “<code>NAPL</code>”
<ul>
<li>depth range: 5.9 m to 13.4 m</li>
</ul></li>
<li>Isla Vista Reef: site code “<code>IVEE</code>”:
<ul>
<li>depth range: 8.2 m to 8.8 m</li>
</ul></li>
<li>Mohawk Reef: site code “<code>MOHK</code>”:
<ul>
<li>depth range: 4.5 m to 6.0 m</li>
</ul></li>
<li>Carpinteria Reef: site code “<code>CARP</code>”:
<ul>
<li>depth range: -2.2 m to -8.8 m</li>
</ul></li>
</ul>
<p>I’ve labeled these on a screenshot of a geographically contextual rendered map preview from the <a href="https://sbclter.msi.ucsb.edu/data/catalog/package/?package=knb-lter-sbc.77">SBC LTER wesite</a>:</p>
<p><img src="figs/sbc-lter-sites.png" class="img-fluid" alt="This map shows the locations of 5 reef study sites in the SBC LTER project." width="701"></p>
<p>Two of these sites, Naples (NAPL) and Isla Vista (IVEE), indicated with a black line connecting them, are in Marine Protected Areas (MPAs).</p>
</section>
</section>
<section id="about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="about-the-data">About the Data</h2>
<section id="dataset-1-sbc-lter-reef-california-spiny-lobster-data" class="level3">
<h3 class="anchored" data-anchor-id="dataset-1-sbc-lter-reef-california-spiny-lobster-data">Dataset 1: SBC LTER: Reef: California Spiny Lobster Data</h3>
<p>This dataset contains records on the abundance, size, and fishing effort on the California Spiny Lobster, <em>Panulirus interruptus</em>, at five SBC LTER study sites, with records from August 2012 to August 2023.</p>
<p>While most data was collected in the month of August at the selected study sites, there is a discrepancy that is very relevant to our analysis. - In 2014, the Arroyo Quemado Reef (site code AQUE) only had data collected in September (56 observations), and the Isla Vista Reef site (site code IVEE) had 6 carapace length observations collected in September and 114 in August of that same year.</p>
<p>This is relevant to our analysis because both carapace length and ocean temperatures are related to the time of year – as more time passes, lobsters grow in size, and water temperatures fluctuate seasonally, as shown in this data visualization of monthly mean temperatures from Shore Stations (one of the Scripps Institution of Oceanography’s programs that works to collect daily temperature (SST) and salinity records at sites along the California coast from La Jolla to Trinidad).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://shorestations.ucsd.edu/"><img src="figs/shore-stations-monthly-mean-temp.png" class="img-fluid figure-img" alt="The figure above shows the monthly temperature means calculated from the past 5 years (2018-2022) at all stations, shown in the solid lines, where each station is a unique color (see legend for details). This plot also shows the long-term average from every station, beginning from whatever time the station started collecting data (for details, see section above titled &quot;General Information&quot;). The long term averages are shown as dashed lines, where color is coordinated for each station. Notably, temperatures peak around August each year."></a></p>
<figcaption class="figure-caption">5 year monthly mean SSTs vs long-term averages</figcaption>
</figure>
</div>
<p>Notes on methods, limitations: “Transects were sampled by two SCUBA divers during daylight hours” – this is notable because lobsters are most active at night, which may add further limitations on the ability of the sample of the population, so any conclusions we come to based on our analysis of these data may not have as much significance or strength in our ability to make claims about the true population.</p>
<p><strong>Data Citation:</strong></p>
<p>Reed, D. &amp; Miller, R. (2023). <em>SBC LTER: Reef: Abundance, size and fishing effort for California Spiny Lobster (Panulirus interruptus), ongoing since 2012 ver 9</em>. [Data File]. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/3595322687af94cd532620ad9db94c77" class="uri">https://doi.org/10.6073/pasta/3595322687af94cd532620ad9db94c77</a> (Accessed 2023-11-22).</p>
<p><strong>Figure Citation</strong>: Carter et. al., 2022.</p>
</section>
<section id="dataset-2-sbc-lter-reef-bottom-temperature-data" class="level3">
<h3 class="anchored" data-anchor-id="dataset-2-sbc-lter-reef-bottom-temperature-data">Dataset 2: SBC LTER: Reef: Bottom temperature data</h3>
<p>This dataset contains records of the water temperature at the bottom (or a relatively low, non-surface depth) at nine of the SBC LTER Reef study sites in 15 minute intervals beginning in 2000 up to July 4th, 2023. I accessed this continuous water temperature dataset via the <a href="https://portal.edirepository.org/nis/metadataviewer?packageid=knb-lter-sbc.13.29">EDI Data Portal</a>. The primary data file on this portal is a .csv, which is 372.8 MB. The key variables that I’ll be using in this data set are:</p>
<ul>
<li><p><strong>Site_code</strong> (default column name: SITE), which contains a string of the name of the field site that each measurement was taken at. Note that the depth of temperature logger at each site varies from 4.95 to 8.15 meters.</p></li>
<li><p><strong>date</strong> (default column name: DATE_LOCAL), which contains the date of observation in the format YYYY-MM-DD</p></li>
<li><p><strong>Temperature in Celsius</strong> (default column name: TEMP_C): Ambient water temperature, measured with Onset tidbit. “tidbit” refers to the measurement instrument, a 32K StowAway TidbiT (-5 deg C to 37 deg C) manufactured by Onset Computer Corporation.</p></li>
</ul>
<p>The NA code for this dataset is -99999.</p>
<p>You can download the data using <a href="https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-sbc.13.29&amp;entityid=d707a45a2cd6eee1d016d99844d537da">this link</a>, or you can copy and paste that download link directly into your <code>read_csv()</code> function as I did in my analysis below.</p>
<p><strong>Data Citation:</strong></p>
<p>Santa Barbara Coastal LTER, D. Reed, and R. Miller. (2023). <em>SBC LTER: Reef: Bottom Temperature: Continuous water temperature, ongoing since 2000 ver 29</em>. [Data File]. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/3071d4179516b5ae56018bfa03fea9dd" class="uri">https://doi.org/10.6073/pasta/3071d4179516b5ae56018bfa03fea9dd</a> (Accessed 2023-12-03).</p>
<section id="section" class="level4">
<h4 class="anchored" data-anchor-id="section"></h4>
<p><strong>I used the following libraries in my analysis and plotting:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for tidy data etc.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for output formatting</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tufte)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># for displaying multiple plots</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># for reading in data</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here) <span class="co"># for reproducible filepaths (like os in Python)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># for analysis</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan) <span class="co"># for creating a diversity index</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># for nice regression output</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="reading-in-the-data" class="level3">
<h3 class="anchored" data-anchor-id="reading-in-the-data">Reading in the Data</h3>
<section id="lobster-data" class="level4">
<h4 class="anchored" data-anchor-id="lobster-data">Lobster Data:</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in lobster abundances &amp; size data from EDI portal link</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>lobster_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-sbc.77.9&amp;entityid=f32823fba432f58f66c06b589b7efac6"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"-99999"</span>)) <span class="co"># specifying NA value labels</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>lobster_size <span class="ot">&lt;-</span> lobster_data <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span>  <span class="co">#  lower_snake_case column names</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this dataset also has abundance, along with other information that we won't be using in our analysis. let's select what we're interested in:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"month"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, date, site, size_mm) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filtering out NA values for size_mm </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(size_mm)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># head(lobster_size, 2) %&gt;% gt()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reef-bottom-temperature-data" class="level4">
<h4 class="anchored" data-anchor-id="reef-bottom-temperature-data">Reef bottom temperature data:</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is a large file (372.8 MiB), so don't be alarmed if this step takes a while</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>water_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://portal.edirepository.org/nis/dataviewer?packageid=knb-lter-sbc.13.29&amp;entityid=d707a45a2cd6eee1d016d99844d537da"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>water_data <span class="ot">&lt;-</span> water_data <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"date"</span> <span class="ot">=</span> date_local) <span class="sc">%&gt;%</span>  <span class="co"># cleaning names</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">"year"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date), <span class="co"># adding columns to join by</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"month"</span> <span class="ot">=</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date)) <span class="sc">%&gt;%</span>   <span class="co"># and filter later on</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, date, site, temp_c)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># head(water_data, 2) %&gt;% gt()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Omitted for brevity, the preliminary outputs show that the primary variables (columns) we’ll be working with are related to the date, site, and measurement variable (<code>size_mm</code> and <code>temp_c</code>). I also found it interesting that the first row in the temperature dataset has a starting date of August, 2002, when the data repository claims that the temperature data ranges back to 2000.</p>
</section>
</section>
</section>
<section id="preliminary-plotting-data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="preliminary-plotting-data-exploration">Preliminary plotting, data exploration</h2>
<p>Let’s check our data for normality to see what our options are in terms of analysis:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check to see if normally distributed</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>mean_size <span class="ot">&lt;-</span> <span class="fu">mean</span>(lobster_size<span class="sc">$</span>size_mm)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>sd_size <span class="ot">&lt;-</span> <span class="fu">sd</span>(lobster_size<span class="sc">$</span>size_mm)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>lobster_size_dist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lobster_size) <span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> size_mm),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"seagreen"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_size,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"skyblue"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="fl">0.8</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_size <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> sd_size),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_size <span class="sc">-</span> (<span class="dv">2</span> <span class="sc">*</span> sd_size),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of California Spiny Lobster Size"</span>, </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"SBC LTER CA data (2012-2023), size measured by carapace length (mm)"</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Carapace Length (mm)"</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>lobster_size_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/lobster-size-dist-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The data appears relatively normally distributed, with a clear aggregation of the data around the mean (light blue, dashed line) and the bulk of the data within two standard deviations away from the mean (black dotted lines). There is also a right tail indicating several counts of higher values.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check to see if normally distributed</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mean_temp <span class="ot">&lt;-</span> <span class="fu">mean</span>(water_data<span class="sc">$</span>temp_c)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>sd_temp <span class="ot">&lt;-</span> <span class="fu">sd</span>(water_data<span class="sc">$</span>temp_c)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>temp_dist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> water_data) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> temp_c),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"cornflowerblue"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">45</span>) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_temp,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">linewidth =</span> <span class="dv">1</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkturquoise"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_temp <span class="sc">+</span> (<span class="dv">2</span> <span class="sc">*</span> sd_temp),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_temp <span class="sc">-</span> (<span class="dv">2</span> <span class="sc">*</span> sd_temp),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Reef bottom temperatures (ºC) (2002-2023)"</span>, </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"at nine SBC LTER Reef sites "</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Temperature (ºC)"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>)</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>temp_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/temp-dist-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The data appears relatively normally distributed, with a clear aggregation to the slight left of the mean (blue dashed line) the bulk of the data falling within 2 standard deviations away from the mean (dotted black lines) . There is also a right tail and right skew.</p>
<p>To know what we should do with our “outlier” September data records, let’s see the number of data points that were collected in September at the two sites we know they were collected at.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sept_data <span class="ot">&lt;-</span> lobster_size <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">9</span>) </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># we can also see that the only year that size data was collected in was 2014</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print(unique(sept_data$year))</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">unique</span>(sept_data<span class="sc">$</span>site))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "IVEE" "AQUE"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># finding proportion of IVEE data collected in September, 2014</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>iv_2014 <span class="ot">&lt;-</span> lobster_size <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"IVEE"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2014</span>) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>iv_sept <span class="ot">&lt;-</span> iv_2014 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">9</span>) </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>iv_sept_pct <span class="ot">&lt;-</span> <span class="fu">nrow</span>(iv_sept) <span class="sc">/</span> <span class="fu">nrow</span>(iv_2014) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># we can also see that all of site AQUE's data in 2014 was collected in September:</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>aq_2014 <span class="ot">&lt;-</span> lobster_size <span class="sc">%&gt;%</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">==</span> <span class="st">"AQUE"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2014</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>aq_sept <span class="ot">&lt;-</span> aq_2014 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">9</span>) </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>aq_sept_pct <span class="ot">&lt;-</span> <span class="fu">nrow</span>(aq_sept) <span class="sc">/</span> <span class="fu">nrow</span>(aq_2014) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The September data records account for "</span>, <span class="fu">round</span>(iv_sept_pct, <span class="dv">2</span>), <span class="st">"% of IVEE Reef's 2014 data points"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The September data records account for 5.26% of IVEE Reef's 2014 data points"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The September data records account for "</span>, <span class="fu">round</span>(aq_sept_pct, <span class="dv">3</span>), <span class="st">"% of AQUE Reef's 2014 data points"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The September data records account for 100% of AQUE Reef's 2014 data points"</code></pre>
</div>
</div>
<p><strong>Preliminary exploration</strong> shows us that the primary month that data was collected in is August (<code>month == 8</code>), with the exception of AQUE and IVEE study sites in 2014, where data was collected in September (site <code>IVEE</code> (around 5% of the site’s 2014 observations) and <code>AQUE</code> (100% of the site’s 2014 observations)).</p>
<p>As 2015 is an important year for our study (El Niño), it is important to have a baseline of lobster carapace size from the year before. Because this data collection began in 2012, leaving out the 2014 September data for the AQUE site would mean only have 2 years of precedent before the El Niño event. Having only</p>
<p>Due to the nature of lobster carapace size increasing over time (positive age-size relationship), if we include the 2014 September data for AQUE, we could get a falsely high “baseline” carapace size for that study site before the El Niño event, which could skew our results. An additional concern I have is about how our average Reef bottom temperature data will interact in all of this. Sea surface temperatures fluctuate over time and both seasonal variation and wind levels can impact ocean temperatures on the California Coast <a href="#fn16" class="footnote-ref" id="fnref16" role="doc-noteref"><sup>16</sup></a><sup>,</sup><a href="#fn17" class="footnote-ref" id="fnref17" role="doc-noteref"><sup>17</sup></a>.</p>
<p>Another issue that comes up with excluding 2014 data for the AQUE study site is that in all other sites, the average carapace size (mm) was greater in 2014 than in 2013. This could mean that by excluding 2014 data for the AQUE study site, in our attempt to avoid a falsely high baseline/comparison point, we are obtaining a falsely low one. If we include both months of 2014 data, the IVEE study site is also skewed to have higher average carapace sizes for that year, as I’ll show later.</p>
<p>To address this discrepancy in the data, In my analysis, I will make two subsets: one in which we keep all of our data (denoted in our outputs as August data and August &amp; September data), and the other will only include data collected in August. We can compare the results of our statistical analyses as we go.</p>
</section>
<section id="averages" class="level2">
<h2 class="anchored" data-anchor-id="averages">Averages</h2>
<section id="making-subsets-taking-names-means" class="level3">
<h3 class="anchored" data-anchor-id="making-subsets-taking-names-means">Making subsets, taking <del>names</del> means</h3>
<p>First, we’ll make two subsets (August vs.&nbsp;August &amp; September) and then we’ll plot the average carapace lengths over time, grouped by site,</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making a tidied subset, finding average count and size per year per site</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># keeping data from August and September</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>lobster_all <span class="ot">&lt;-</span> lobster_size <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, site) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_size =</span> <span class="fu">mean</span>(size_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_size =</span> <span class="fu">max</span>(size_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_size =</span> <span class="fu">min</span>(size_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># keeping August data only</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>lobster_august <span class="ot">&lt;-</span> lobster_size <span class="sc">%&gt;%</span>  </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">month</span>(date) <span class="sc">==</span> <span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, site) <span class="sc">%&gt;%</span> </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_size =</span> <span class="fu">mean</span>(size_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">max_size =</span> <span class="fu">max</span>(size_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">min_size =</span> <span class="fu">min</span>(size_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">August &amp; September</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">August</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot average lobster size per site per year, including September data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>lobster_size_plot_all <span class="ot">&lt;-</span> lobster_all <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_size,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_size,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># carapace length at sexual maturity </span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">63.5</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># catch length</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">82.55</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2015 El Niño</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2015</span>,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site) <span class="sc">+</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">#color = "Site",</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Carapace Length (mm)"</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Annual average Spiny Lobster carapace length (2012-2023)"</span>,</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"organized by SBC LTER study site"</span>) <span class="sc">+</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>lobster_size_plot_all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/lobster-avg-plot-all-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot average lobster size per site per year</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>lobster_size_plot_august <span class="ot">&lt;-</span> lobster_august <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_size,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_size,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># showing lobster size of sexual maturity </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">63.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"dimgrey"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">82.55</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2015</span>,  <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> <span class="co"># showing 2015 El Niño</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site) <span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#color = "Site",</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Carapace Length (mm)"</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Annual average Spiny Lobster carapace length (2012-2023)"</span>,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"organized by SBC LTER study site, data collected in August only"</span>) <span class="sc">+</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>lobster_size_plot_august</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/lobster-avg-plot-august-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<ul>
<li><p>The vertical dotted line indicates the first year of the 2015-2016 El Niño</p></li>
<li><p>The lower dashed horizontal line indicates the average estimated size (and corresponding age) at which the California Spiny Lobster reaches sexual maturity: around 2.5 inches (63.5 mm), or 58mm and 5 years old for Males and 70 mm and roughly 7 years old for Females <a href="#fn18" class="footnote-ref" id="fnref18" role="doc-noteref"><sup>18</sup></a>, <a href="#fn19" class="footnote-ref" id="fnref19" role="doc-noteref"><sup>19</sup></a>.</p></li>
<li><p>The higher dashed horizontal line indicates the minimum legal catch size: a carapace measuring 3.25 inches or 82.55 mm, or around 8-13 years old (estimated age range of 7-11 for Males, 8-13 for Females) <a href="#fn20" class="footnote-ref" id="fnref20" role="doc-noteref"><sup>20</sup></a>.</p></li>
</ul>
<section id="interpretation" class="level4">
<h4 class="anchored" data-anchor-id="interpretation">Interpretation</h4>
<ul>
<li>Note the significant difference in slopes between year 2014 and 2015 data points for average carapace size (mm) at the AQUE study site between the September-inclusive and September-exclusive (August only) plots. There is also a subtle change at the IVEE study site between 2014 and 2015 between the two plots as well, supporting what we know about how carapace lengths increase over time, even on a monthly level.</li>
</ul>
<p>Taking the average size (carapace length) per site per year shows potentially interesting trends. At all sites, there is a notable drop in average carapace length (mm) from 2014 to 2015, both including and excluding September 2014 data. This significant change in slope of the lines connecting data points for average carapace length coincides with the 2015/2016 El Niño, which was the strongest over a 145 year record <a href="#fn21" class="footnote-ref" id="fnref21" role="doc-noteref"><sup>21</sup></a>. During El Niño events, sea surface temperatures (SST) rise, and SST estimates can also serve as an indicator for coastal ocean temperature levels – if SST is rising, the temperatures at the bottom of relatively shallow, coastal reef sites are likely rising as well. In some cases, depending on the thermocline (inverted or not) that a reef experiences, Sea Bottom Temperatures (SBT) can even be higher than SST <a href="#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a>.</p>
<p>These visualizations suggests that the Santa Barbara Coast LTER sites are somewhat of a haven for California Spiny lobsters in their first few of years of breeding, as stated on the CADFW info page on the California Spiny lobster. As this graph shows an <em>average</em> carapace size, and lobsters can vary significantly in size depending on their age, these research sites are likely home to a wide age and developmental stage range of lobsters.</p>
<p>Let’s move on to incorporate the other essential data in investigating the relationship between reef bottom temperatures and average lobster size (carapace length, mm), – Reef bottom temperature!</p>
</section>
</section>
<section id="average-reef-bottom-temperature-over-time" class="level3">
<h3 class="anchored" data-anchor-id="average-reef-bottom-temperature-over-time">Average reef bottom temperature over time</h3>
<p>Our reef bottom temperature data is pretty huge – temperatures were recorded every 15 minutes at multiple SBC LTER study sites since 2002.</p>
<p>Regarding our previous dilemma of “to include or not to include” September carapace length data, we now have an opportunity to decide how we want to aggregate our reef bottom temperature data. I could filter it by month, keeping temperature records only from the month of August, or I could include September as well. I could also have another different subset, which incorporates temperature data from August and September only at sites IVEE and AQUE for 2014, and filter it to only keep August dates for all other sites that year and all sites at all years. This can get pretty complicated pretty quickly, as the easiest inclusive option – filtering just for August and September – has the drawback of interfering with the estimated relationship between average carapace length and water temperature for the majority of our data.</p>
<p>In my analysis, I’ve decided to only select reef bottom temperature records in the month of August, which I then average and join with the lobster data by year and by site.</p>
<p>First, we’ll plot the average August reef bottom temperature per year across all sites, noting the spike in temperature in the first year of the 2015/2016 El Niño. This dataset ranges from 2002 to 2023, but the last month of the record is July, so we’ll have August data spanning from 2002-2023 before we join it with our lobster data set. Then, we’ll plot the average August temperatures over time by site, comparing with the average size by site plot created earlier.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prepping water temp data to compare with lobster data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># finding average August reef bottom temperatures across all sites over </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the full time range of our water dataset (2002-2022)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>allsites_aug_temps <span class="ot">&lt;-</span> water_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">8</span>)) <span class="sc">|&gt;</span> <span class="co"># select August temps</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>((<span class="fu">unique</span>(lobster_size<span class="sc">$</span>site)))) <span class="sc">%&gt;%</span> <span class="co"># selecting Lobster data study sites</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span>  </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_temp =</span> <span class="fu">mean</span>(temp_c, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># find avg temp</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>august_temps <span class="ot">&lt;-</span> water_data <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>((<span class="fu">unique</span>(lobster_size<span class="sc">$</span>site)))) <span class="sc">%&gt;%</span> </span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">==</span> <span class="dv">8</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>mean_aug_temp <span class="ot">&lt;-</span> <span class="fu">mean</span>(august_temps<span class="sc">$</span>temp_c)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"The average August reef bottom temperature across the 5 reef study sites from 2002-2022 is "</span>, <span class="fu">round</span>(mean_aug_temp, <span class="dv">2</span>), <span class="st">"ºC."</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The average August reef bottom temperature across the 5 reef study sites from 2002-2022 is 16.19ºC."</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making a subset to show selected year range</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>allsites_aug_temp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> allsites_aug_temps) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> avg_temp)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> avg_temp)) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2015</span>,  <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> <span class="co"># showing 2015 El Niño </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="fu">seq</span>(<span class="dv">2000</span>,<span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">5</span>)), </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">2002</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Reef Bottom Temperatures in August Over Time"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"across selected SBC LTER study sites (2002-2022)"</span>, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Temperature (ºC)"</span>) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x=</span><span class="dv">2014</span>, <span class="at">y=</span><span class="dv">19</span>, <span class="at">label=</span><span class="st">"El Niño"</span>, <span class="at">angle=</span><span class="dv">0</span>) </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>allsites_aug_temp_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/water-temp-plot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There is a clear spike in average reef bottom temperature in August of 2015 across all study sites, and a significant dip in 2010. There is also a notable spike (and maximum peak) at all sites in 2018. There were record-breaking SST anomalies in 2018 at many points along the Southern California Coastline, particularly along La Jolla, San Diego, where the Scripps Institution of Oceanography recorded water temperatures of 25.9 degrees Celsius, beating the previous record of 25.8 C from 1931 <a href="#fn23" class="footnote-ref" id="fnref23" role="doc-noteref"><sup>23</sup></a><sup>,</sup> <a href="#fn24" class="footnote-ref" id="fnref24" role="doc-noteref"><sup>24</sup></a>.</p>
<p>Now we’ll join the lobster size data and the temperature data, which will narrow our time range to 2012-2022.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making august-only water temp subset</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>august_site_temps <span class="ot">&lt;-</span> water_data <span class="sc">%&gt;%</span>  </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">8</span>)) <span class="sc">%&gt;%</span>  <span class="co"># select August temps</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>((<span class="fu">unique</span>(lobster_size<span class="sc">$</span>site)))) <span class="sc">%&gt;%</span>  <span class="co"># selecting Lobster data study sites</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, site) <span class="sc">%&gt;%</span>  <span class="co"># grouping by year and site to join (only 1 month, no need to group by it)</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_temp =</span> <span class="fu">mean</span>(temp_c, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># find avg temp</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>lobster_temps_august <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(lobster_august, august_site_temps) <span class="sc">%&gt;%</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>max_size, <span class="sc">-</span>min_size)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co"># this will make sure that we're comparing the same month for each site and each year, </span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># so for most years, sites, and months, it'll be august data</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># but for the 2014 AQUE and IVEE data collected in September,</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>site_temps <span class="ot">&lt;-</span> water_data <span class="sc">%&gt;%</span>  </span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">month</span>(date) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">9</span>)) <span class="sc">%&gt;%</span>  <span class="co"># select August and September temps</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>((<span class="fu">unique</span>(lobster_size<span class="sc">$</span>site)))) <span class="sc">%&gt;%</span>   <span class="co"># selecting Lobster data study sites</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month, site) <span class="sc">%&gt;%</span>  <span class="co"># grouping by year, month, and site, so we can join by all </span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_temp =</span> <span class="fu">mean</span>(temp_c, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># find avg temp</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># we'll be pairing those averages with average temperature in September</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>lobster_temps_all <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(site_temps,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                                lobster_all) <span class="sc">%&gt;%</span>  <span class="co"># this df also has maintained its "month" column</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>max_size, <span class="sc">-</span>min_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Avg. Temperatures</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Avg. Sizes</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting august temp trends per site, within our lobster data time range</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>august_temp_trends <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lobster_temps_august, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_temp)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">16.19</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2015</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span> <span class="co"># showing 2015 El Niño</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> site)) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">minor_breaks =</span> <span class="fu">seq</span>(<span class="dv">2012</span>,<span class="dv">2022</span>, <span class="at">by=</span><span class="dv">1</span>),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2012</span>,<span class="dv">2022</span>, <span class="at">by=</span><span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site) <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"transparent"</span>)) <span class="sc">+</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Reef Bottom Temperatures in August Over Time"</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"organized by selected SBC LTER study sites (2012-2022)"</span>, </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Temperature (ºC)"</span>) <span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  annotate("text", x=2011, y=19, label="El Niño", angle=0) # label looks messy on faceted plot, but is worthwhile to add on individual site plots</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="co"># we're coloring and facet wrapping by site, so a legend is redundant</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>august_temp_trends </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/temp-site-plots-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>lobster_size_plot_august</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/avg-size-plot-temp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p><em>The dotted vertical line in each graph once again shows the beginning of the 2015/2016 El Niño. The dashed horizontal lines in the temperature plots show the 20-year average August reef bottom temperature (from 2002-2022). The dashed horizontal lines in the average size plot show the carapace lengths at sexual maturity (lower) and catch size (higher).</em></p>
<p>Comparing our average temperature and average size plots side by side, there seems to be visual evidence for some trends or relationship between average temperature and average carapace length. At all sites, in 2015 when the average August temperature spikes, average carapace lengths decrease. At the Naples reef site, after the temperature spikes in 2018 and falls dramatically in 2019, we see a spike in average carapace length in 2019. As average August reef bottom temperatures continue to fall in 2020 in Naples, lower than the average temperature over the previous 8 years, the average carapace size seems to drop slightly at that site. The most extreme drops in average carapace length at sites Arroyo Quemado, Carpinteria, and Mohawk happen when the temperature spikes in 2015. When temperatures fall back down closer to the 20-year average August reef bottom temperature in 2016, the Arroyo Quemado reef site is the only site where average carapace lengths seem to recover within that annual cycle. Unfortunately, we are missing temperature data at the Mohawk reef site in 2017. Overall, there seem to be complexities in the population structures at all sites, with similar overall trends in average August reef bottom temperature.</p>
</section>
</section>
<section id="lobster-size-reef-temperature-relationship" class="level2">
<h2 class="anchored" data-anchor-id="lobster-size-reef-temperature-relationship">Lobster size &amp; reef temperature relationship</h2>
<p>In this section, we will:<br>
</p>
<ul>
<li><p>look at the general relationship between our size and temperature variables (plot)</p></li>
<li><p>run multiple linear regression (<code>size ~ temp + site</code>)</p></li>
<li><p>run multiple regression with an interaction term (<code>size ~ temp + site + temp:site</code>)</p></li>
<li><p>run simple linear regression (<code>size ~ temp</code>) for each site</p></li>
</ul>
<section id="simple-linear-model-plot" class="level3">
<h3 class="anchored" data-anchor-id="simple-linear-model-plot">Simple linear model plot</h3>
<p>Before we dive into the complexities of the relationship between average carapace length in August and average reef bottom temperature in August, let’s take a more general look at the combined data that we’re working with.</p>
<p>Here we’ll plot our joined size &amp; temperature data subset with data exclusively collected in August each year from 2012-2022:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># preliminary plot of the joined data</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lobster_temps_august_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> lobster_temps_august, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">x =</span> avg_temp,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">y =</span> avg_size)) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">'lm'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula=</span> y<span class="sc">~</span>x,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">na.rm =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span><span class="st">"seagreen"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">se=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">14.5</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">94</span>)) <span class="sc">+</span> </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  ggpubr<span class="sc">::</span><span class="fu">stat_regline_equation</span>(</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(eq.label))) <span class="sc">+</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Average Lobster Size by Average Reef Bottom Temperature (August, annual averages)"</span>, </span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"SBC LTER data on California Spiny Lobster carapace length (mm), reef bottom temperatures (ºC)"</span>, </span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Average Temperature (ºC)"</span>,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Average Size (mm)"</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># view plots</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>lobster_temps_august_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/lobster-temp-rel-plot-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>There seems to be a relationship here, where as average reef bottom temperatures increase, average lobster carapace lengths decrease, though with relatively few data points here and the impact that site may have on this relationship not accounted for in this plot, it is hard to make any real claims.</p>
</section>
<section id="multiple-regression" class="level3">
<h3 class="anchored" data-anchor-id="multiple-regression">Multiple regression</h3>
<p>With our current data, we can model the relationship between average carapace length (mm) in August with the following multiple regression equation:</p>
<p><span class="math display">\[\mu CL_i =\beta_{0}+\beta_{1} \mu Temp_i +\beta_{2} \text Site+\varepsilon_i\]</span> Where</p>
<ul>
<li><span class="math inline">\(\mu CL\)</span> is the average carapace length, in millimeters, in August</li>
<li><span class="math inline">\(\beta_{0}\)</span> is the intercept, or expected average carapace length, in millimeters, when the average August temperature is 0º C and site is held constant (for our reference site, AQUE)</li>
<li><span class="math inline">\(\beta_{1}\)</span> is the slope or expected change in average carapace length given a 1 unit change in average temperature (1º C), when site is held constant (for our reference site, AQUE)</li>
<li><span class="math inline">\(\beta_{2}\)</span> is the difference in slope or expected change in average carapace length given a 1 unit change in average temperature (1º C) between our reference group (site AQUE) and each other site.</li>
<li><span class="math inline">\(\varepsilon\)</span> is our error term, containing everything else that impacts average expected carapace length as measured in August.</li>
</ul>
<p>Once again, whenever I say “average”, followed by any term, I’m referring to the average of that variable <em>as measured in August</em> of each year.</p>
<p>Multiple Regression: <span class="math display">\[\mu CL_i =\beta_{0}+\beta_{1} \mu Temp_i +\beta_{2} \text Site+\varepsilon_i\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run simple linear regression on temp and size, taking temperature differences at each site into account</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for august-only data</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>lobster_temp_reg_august <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp <span class="sc">+</span> site, <span class="at">data =</span> lobster_temps_august)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lobster_temp_reg_august)</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># for september-inclusive lobster data and august-only water temp data</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>lobster_temp_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp <span class="sc">+</span> site, <span class="at">data =</span> lobster_temps_all)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lobster_temp_reg)</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># use sjPlot to show a comparison of the outputs from running these models</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(lobster_temp_reg_august, lobster_temp_reg,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                  <span class="co">#  title = "Multiple Regression: formula = average  ~ avg_temp + site",</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">"August"</span>, <span class="st">"August &amp; September"</span>),</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">3</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">August</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">August &amp; September</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">93.915</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">77.190&nbsp;–&nbsp;110.640</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">88.867</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">78.728&nbsp;–&nbsp;99.006</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.156</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.106&nbsp;–&nbsp;-0.206</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.018</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.838</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.407&nbsp;–&nbsp;-0.269</td>
<td style="text-align: center;"><strong>0.004</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [CARP]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.408</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-3.255&nbsp;–&nbsp;4.071</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.824</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.291</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.166&nbsp;–&nbsp;2.748</td>
<td style="text-align: center;">0.815</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [IVEE]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.057</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-3.751&nbsp;–&nbsp;3.864</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.976</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.285</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.226&nbsp;–&nbsp;2.796</td>
<td style="text-align: center;">0.822</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [MOHK]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.106</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-5.860&nbsp;–&nbsp;1.648</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.265</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.207</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-4.725&nbsp;–&nbsp;0.312</td>
<td style="text-align: center;">0.085</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [NAPL]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">6.975</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">3.296&nbsp;–&nbsp;10.654</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">6.843</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">4.380&nbsp;–&nbsp;9.306</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">53</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">108</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.437 / 0.377</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.407 / 0.378</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="regression-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="regression-interpretation"><strong>Regression Interpretation:</strong></h4>
<p><strong>Interpretation of coefficients in August-only Regression:</strong></p>
<ul>
<li><strong>Intercept:</strong> at the Arroyo Quemado Reef (AQUE) study site (our reference group), when the reef bottom temperature is 0º Celsius, the expected lobster carapace size is 93.91 mm (nonsensical, from the SBC LTER records of reef bottom temperatures, which have been recorded every 15 minutes, ongoing since 2002, the minimum recorded temperature of all time in our data set is <code>r(min(water_data$temp_c))</code> º Celsius).</li>
<li><strong>Slope: <code>avg_temp</code>:</strong> Holding <code>site</code> constant (comparing average lobster carapace lengths and average water temperatures only to those of the same SBC LTER study site), at the AQUE study site, given a one unit change in average reef bottom temperature (an increase of 1º Celsius) as measured in August, we expect the average carapace length of lobsters to change by -1.16 mm.</li>
</ul>
<p><strong>Interpretation of <code>site</code> coefficients:</strong></p>
<p>Note, the coefficients following <code>avg temp</code> are to be interpreted in relation to <code>avg temp</code>, as it represents AQUE, our reference group.</p>
<ul>
<li><code>siteCARP</code>: For the SBC LTER Carpinteria Reef study site, given a 1º Celsius change (increase) in average reef bottom temperature measured in August, we expect to see a 0.41 mm increase in average lobster carapace size as compared to the AQUE site expected slope of -1.14 mm per 1 degree increase in Celsius, for a total expected change in average lobster carapace length of -0.75 mm.</li>
</ul>
<p>(moving forward, I will only describe the overall or total expected change (<code>site [___]</code> + <code>avg temp</code>)):</p>
<ul>
<li><code>siteIVEE</code>: For the SBC LTER Isla Vista Reef study site, given a 1º Celsius increase (in average reef bottom temperature in August), we expect to see a change in average lobster carapace length of -1.1 mm.</li>
<li><code>siteMOHK</code>: For the SBC LTER Mohawk Reef study site, given a 1º Celsius increase in average reef bottom temperature in August, we expect to see a change in average lobster carapace length of -3.26 mm.</li>
<li><code>siteNAPL</code>: For the SBC LTER Naples Reef study site, given a 1º Celsius increase in average reef bottom temperature in August, we expect to see a change in average lobster carapace length of 5.82 mm. This positive value is perhaps a sign that something more complicated is going on at this site, or perhaps in general. It also doesn’t seem to align with the visual evidence in our average temperature- and average CL-by-site plot earlier: following the temperature spike in 2015, the sample average carapace length fell, and after average temperatures began to decrease significantly following the 2018 temperature spike, the NAPL site showed a steadily, significantly increasing sample average carapace length.</li>
</ul>
<p><span class="math inline">\(R^2\)</span>:</p>
<p>Because we have multiple terms on the right side of the equation (temp + site), the adjusted <span class="math inline">\(R^2\)</span> value is more relevant and better representative of our model. This adjusted <span class="math inline">\(R^2\)</span> value tells us that around 38% of the variation in our data can be explained by our model, or that 38% of the change in average carapace length in August can be explained by the average reef bottom temperature in August and which study site the lobster is located in.</p>
<p><strong>Interpreting Uncertainty, Significance:</strong></p>
<p>There is notably more uncertainty in the September-inclusive regression than in the regression run on data collected exclusively in August, with wider confidence intervals and fewer estimates holding under an <span class="math inline">\(\alpha\)</span> of 0.05 (bolded p-values).</p>
<p>The intercept estimate is a significant yet nonsensical estimate, with a significance level of 0 being met in both regressions.</p>
<p>In both regression summaries, the Naples reef site has it’s own relationship between average water temperature and average carapace length going in a different direction than all of the other sites – yet it’s the most statistically significant estimate of all of our sites.</p>
<p>The Arroyo Quemado Reef site has a statistically significant estimate under the August regression, but not under the August &amp; September regression. This makes sense intuitively, as the variation in carapace size and temperature in September does not follow the same pattern as the rest of our data (temperatures in September are cooler than August, and the carapace sizes of our lobsters will continue to grow). From here on out, we will only be using August data in our regression models.</p>
</section>
</section>
<section id="multiple-regression-with-interaction" class="level3">
<h3 class="anchored" data-anchor-id="multiple-regression-with-interaction">Multiple regression with interaction</h3>
<p>As temperatures vary in each site, we can add an interaction term to our model to see if this may be a factor that impacts or is contributing to our uncertainty. This new equation is:</p>
<p><span class="math display">\[\mu CL_i =\beta_{0} + \beta_{1} \mu Temp_i +\beta_{2} \text Site + \beta_{3} (\mu Temp_{i} * \text Site) +  \varepsilon_i\]</span> Where:</p>
<ul>
<li><span class="math inline">\(\mu CL\)</span> is the average carapace length, in millimeters, in August</li>
<li><span class="math inline">\(\beta_{0}\)</span> is the intercept, or expected average carapace length, in millimeters, when the average August temperature is 0º C and site is held constant (for our reference site, AQUE)</li>
<li><span class="math inline">\(\beta_{1}\)</span> is the slope or expected change in average carapace length given a 1 unit change in average temperature (1º C) in August, when site is held constant (for our reference site, AQUE)</li>
<li><span class="math inline">\(\beta_{2}\)</span> is the difference in slope or expected change in average carapace length given a 1 unit change in average temperature (1º C) in August between our reference group (site AQUE) and each other site.</li>
<li><span class="math inline">\(\beta_{3}\)</span> is the difference in slopes between our different sites, where slope is the average change in carapace length in August given a 1º C change in average reef bottom temperature in August for each site</li>
<li><span class="math inline">\(\varepsilon\)</span> is our error term, containing everything else that impacts average expected carapace length as measured in August.</li>
</ul>
<p>Now that we know what our equation means, let’s run the multiple regression with this added interaction term on our August-only dataset:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run multiple linear regression on temp and size, taking temperature differences at each site into account</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for august-only data</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>multi_reg_int_aug <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp <span class="sc">+</span> site <span class="sc">+</span> avg_temp<span class="sc">:</span>site,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> lobster_temps_august)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(multi_reg_int_aug)</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use sjPlot to show a comparison of the outputs from running these models</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(multi_reg_int_aug,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"Multiple regression with interaction"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">""</span>),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>                <span class="co">#  dv.labels = c("Average lobster carapace length (mm)"),</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Multiple regression with interaction</caption>
<tbody>
<tr class="odd">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal; nodv  text-align: left;">Predictors</td>
<td>Estimates</td>
<td>CI</td>
<td>p</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">114.066</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">73.977&nbsp;–&nbsp;154.154</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.315</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-4.615&nbsp;–&nbsp;-0.015</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.049</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [CARP]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-35.333</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-88.638&nbsp;–&nbsp;17.972</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.188</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [IVEE]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-31.745</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-86.520&nbsp;–&nbsp;23.030</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.249</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [MOHK]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-23.659</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-78.688&nbsp;–&nbsp;31.370</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.391</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">site [NAPL]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.429</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-55.379&nbsp;–&nbsp;50.521</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.927</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp × site [CARP]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">2.064</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.007&nbsp;–&nbsp;5.136</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.182</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp × site [IVEE]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.875</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.369&nbsp;–&nbsp;5.118</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.250</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp × site [MOHK]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">1.241</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.940&nbsp;–&nbsp;4.421</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.436</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp × site [NAPL]</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.526</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.543&nbsp;–&nbsp;3.595</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.731</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">53</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.469 / 0.358</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="abbreviated-regression-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="abbreviated-regression-interpretation"><strong>Abbreviated Regression Interpretation:</strong></h4>
<p>Several new features stand out in this regression output. The first is the change in extremity of our estimated site coefficients. The first <code>avg temp</code> coefficient can be interpreted as the expected change in average carapace length (mm) in August given a 1 unit change in our temperature variable (1º C increase in average temperature in August) holding site constant, at our reference group site AQUE.</p>
<p>The small p-value suggests that the probability of getting results at least as extreme as this if the null hypothesis were true is very low. That being said, only our nonsensical intercept and first coefficient, avg_temp, are statistically significant under an <span class="math inline">\(\alpha\)</span> of 0.05. In this interaction model, we got an adjusted <span class="math inline">\(R^2\)</span> value of around 0.36, which would suggest that roughly 36% of the variation in our data can be explained by our model, the low significance levels coupled with the higher adjusted <span class="math inline">\(R^2\)</span> value in our non-interaction multiple regression model on August-only data of roughly 0.38 or 38% suggests that incorporating this interaction term does not yield a better model for our sample data.</p>
<p>The coefficients labeled <code>avg temp x site [XXXX]</code> are the site specific differences in slopes for average reef bottom temperature from the slope of site AQUE described above (<code>avg temp</code>). <strong>None of these coefficient estimates are significant, which indicates that the effect of average reef bottom temperature is not meaningfully different across the study sites.</strong></p>
<p>Based on the nuances in the coefficients and uncertainty in the two previous models, I decided to model each site individually in a simple linear regression model.</p>
</section>
</section>
<section id="simple-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="simple-linear-regression">Simple linear regression</h3>
<p>We can also run our linear regression model on each site, which would shift our first multiple regression equation to a simple linear model of:</p>
<p><span class="math display">\[\mu CL_i =\beta_{0}+\beta_{1} \mu Temp_i +\varepsilon_i\]</span> where:</p>
<ul>
<li><span class="math inline">\(\mu CL\)</span> is the average carapace length, in millimeters, in August at the site that we’re running this regression for</li>
<li><span class="math inline">\(\beta_{0}\)</span> is the intercept, or expected average carapace length, in millimeters, when the average August temperature is 0º Celsius</li>
<li><span class="math inline">\(\beta_{1}\)</span> is the slope or expected change in average carapace length in August given a 1 unit (1º C) change in average temperature in August</li>
</ul>
<p>The main change here is that our <span class="math inline">\(\beta_{0}\)</span> and <span class="math inline">\(\beta_{1}\)</span> terms are now about the particular site we’re running our regression model on, rather than having a clause of “holding site constant” or based on a reference group (site AQUE, previously).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to quickly make individual subsets for each site, we can make a subset function:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>site_selection <span class="ot">&lt;-</span> <span class="cf">function</span>(siteID, data_set){</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  data_set <span class="sc">%&gt;%</span> <span class="fu">filter</span>(site <span class="sc">%in%</span> <span class="fu">c</span>(siteID))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># then apply this function for each site:</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>aque_subset <span class="ot">&lt;-</span> <span class="fu">site_selection</span>(<span class="st">"AQUE"</span>, lobster_temps_august)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>carp_subset <span class="ot">&lt;-</span> <span class="fu">site_selection</span>(<span class="st">"CARP"</span>, lobster_temps_august)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>ivee_subset <span class="ot">&lt;-</span> <span class="fu">site_selection</span>(<span class="st">"IVEE"</span>, lobster_temps_august)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>mohk_subset <span class="ot">&lt;-</span> <span class="fu">site_selection</span>(<span class="st">"MOHK"</span>, lobster_temps_august)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>napl_subset <span class="ot">&lt;-</span> <span class="fu">site_selection</span>(<span class="st">"NAPL"</span>, lobster_temps_august)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>aque_simple_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp, <span class="at">data =</span> aque_subset)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>carp_simple_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp, <span class="at">data =</span> carp_subset)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>ivee_simple_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp, <span class="at">data =</span> ivee_subset)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>mohk_simple_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp, <span class="at">data =</span> mohk_subset)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>napl_simple_reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> avg_size <span class="sc">~</span> avg_temp, <span class="at">data =</span> napl_subset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the 3 non-MPA sites' regression outputs</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(aque_simple_reg, carp_simple_reg, mohk_simple_reg, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"Simple linear regression: SBC LTER Reef study sites (not in MPAs)"</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">"Arroyo Quemado"</span>, <span class="st">"Carpinteria"</span>, <span class="st">"Mohawk"</span>),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Simple linear regression: SBC LTER Reef study sites (not in MPAs)</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Arroyo Quemado</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Carpinteria</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Mohawk</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">Estimates</td>
<td style="text-align: center;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">114.066</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">77.205&nbsp;–&nbsp;150.926</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>&lt;0.001</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">78.733</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">49.689&nbsp;–&nbsp;107.776</td>
<td style="text-align: center;"><strong>&lt;0.001</strong></td>
<td style="text-align: center;">90.407</td>
<td style="text-align: center;">51.685&nbsp;–&nbsp;129.129</td>
<td style="text-align: center;"><strong>0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-2.315</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-4.430&nbsp;–&nbsp;-0.200</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.036</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.250</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.933&nbsp;–&nbsp;1.432</td>
<td style="text-align: center;">0.744</td>
<td style="text-align: center;">-1.074</td>
<td style="text-align: center;">-3.330&nbsp;–&nbsp;1.182</td>
<td style="text-align: center;">0.304</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">10</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">11</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">10</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.443 / 0.374</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.012 / -0.097</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.131 / 0.022</td>
</tr>
</tbody>
</table>


</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the 2 MPA sites' regression outputs</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sjPlot<span class="sc">::</span><span class="fu">tab_model</span>(ivee_simple_reg, napl_simple_reg, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">title =</span> <span class="st">"Simple linear regression: SBC LTER Reef study sites (within MPAs)"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dv.labels =</span> <span class="fu">c</span>(<span class="st">"Isla Vista Reef"</span>, <span class="st">"Naples Reef"</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Simple linear regression: SBC LTER Reef study sites (within MPAs)</caption>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">&nbsp;</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Isla Vista Reef</td>
<td colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-top: double; font-style: normal; font-weight: bold; padding: 0.2cm;">Naples Reef</td>
</tr>
<tr class="even">
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Predictors</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">p</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">Estimates</td>
<td style="text-align: center; border-bottom: 1px solid; font-style: italic; font-weight: normal;">CI</td>
<td style="text-align: center;">p</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">(Intercept)</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">82.321</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">37.505&nbsp;–&nbsp;127.136</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;"><strong>0.002</strong></td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">111.637</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">59.623&nbsp;–&nbsp;163.651</td>
<td style="text-align: center;"><strong>0.001</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">avg temp</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-0.440</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-3.187&nbsp;–&nbsp;2.306</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">0.725</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-1.789</td>
<td style="text-align: left; padding: 0.2cm; vertical-align: top;">-4.843&nbsp;–&nbsp;1.265</td>
<td style="text-align: center;">0.218</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">Observations</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">11</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm; border-top: 1px solid;">11</td>
</tr>
<tr class="even">
<td style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">R<sup>2</sup> / R<sup>2</sup> adjusted</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.014 / -0.095</td>
<td colspan="3" style="text-align: left; padding: 0.2cm; vertical-align: top; padding-top: 0.1cm; padding-bottom: 0.1cm;">0.163 / 0.070</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="analysis-of-simple-linear-regression-results" class="level4">
<h4 class="anchored" data-anchor-id="analysis-of-simple-linear-regression-results"><strong>Analysis of simple linear regression results</strong></h4>
<p>I was genuinely surprised by these outputs. I expected the individual relationships between average lobster size (carapace length) and average reef bottom temperature to be stronger and more statistically significant when broken down on a simple site-by-site level.</p>
<p>I particularly expected to see a new, <em>negative</em> estimate for the Naples reef site, which had previously had an oddly highly positive estimate that was surprisingly statistically significant under an <span class="math inline">\(\alpha\)</span> level of 0.0001. When isolating that site’s data, we now have a negative estimate of roughly -1.8, but a p-value of 0.2, which is much larger than the previous p-value. This means that the probability of getting results at least as extreme as ours if the null hypothesis were true is around 20%.</p>
<p><em>Because these are simple linear models, we can use the</em> <span class="math inline">\(R^2\)</span> values in our interpretation of the results, rather than the adjusted <span class="math inline">\(R^2\)</span> values.</p>
<ul>
<li>The highest <span class="math inline">\(R^2\)</span> value was at the Arroyo Quemado reef site, with a value of 0.44, meaning that around 44% of the variation in our data at the AQUE site can be explained by our model, or 44% of the variation in average lobster carapace size in August can be explained by the average reef bottom temperature in August. With both the intercept (nonsensical) and average temperature coefficient being statistically significant results under an <span class="math inline">\(\alpha\)</span> level of 0.05, this is an exciting result.</li>
</ul>
<p>That’s pretty much where the statistically significant “good news” ends, though classifying this as “good” or “bad” is wrong and limits our ability to learn from these results :)</p>
<ul>
<li><p>The next-highest <span class="math inline">\(R^2\)</span> value is from our Naples Reef regression, and it tells us that roughly 16% of the variation in our Naples Reef data can be explained by our model. I explained the significance of the estimates earlier, and they ultimately lead me to think that there is a lot more going on at the Naples site that is impacting average lobster size than just average reef bottom temperature.</p></li>
<li><p>The third-highest <span class="math inline">\(R^2\)</span> value is from the Mohawk Reef regression output and suggests that around 13% of the variation in the Mohawk Reef data can be explained by our model (change in average reef bottom temperatures in August). The nonsensical intercept of 90 has a high significance level, and the estimate for the average temperature coefficient is roughly -1.1, which means that for a 1 unit change in average reef bottom temperature in August, average lobster carapace size in August at the Mohawk Reef site is expected to decrease by around 1.1 mm. This estimate has a p-value of 0.3, which is not statistically significant under our <span class="math inline">\(\alpha\)</span> level of 0.05.</p></li>
</ul>
<p>The other two sites – Carpinteria Reef and Isla Vista Reef – have high p-values for their coefficient estimates and very low <span class="math inline">\(R^2\)</span> values, with just under 1.5% of the variation in the data able to be explained by the models.</p>
<p>Some key takeaways from this are that the Naples site results particularly changed after being separated from the rest of the data – the sign and degree of the temperature coefficient changed, though its significance level decreased and had a relatively low <span class="math inline">\(R^2\)</span> value.</p>
<p><strong>Another key takeaway is that our model works fairly well for the data at the Arroyo Quemado site: we obtained statistically significant estimates and an</strong> <span class="math inline">\(R^2\)</span> <strong>value of 0.44 with just one term on the right side of the equation. This means that roughly 44% of the variation in our data at this site can be explained by average reef bottom temperature in August.</strong></p>
<p>A significant limitation to this approach is that each model is run on a very limited dataset of only 10 points – yearly averages from 2012-2022 leaves us with 11 points per subset for all sites other than AQUE, which has 10 due to the lack of August lobster size data in 2014, and MOHK, which has 10 due to the lack of August temperature data in 2017.</p>
</section>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The limitations of the lobster data and the low quantity of statistically significant results lead me to question the strength of the results in this study for the most part. One notable exception has been with the Arroyo Quemado Reef data, where – with a simple linear model – the regression results suggest that roughly 44% of the variation in the average lobster carapace size data collected in August at that site can be explained by average reef bottom temperatures in August.</p>
<p>Early on in my data analysis process, I considered dropping the AQUE site altogether due to its missing August data in 2014 and unique presence of September data in that year. After continuing on with my analysis, eventually making subsets with and without that September data, running various levels of regression, and plotting averages left and right, I came to appreciate the challenge that this data posed. If I had dropped it, I would have completely missed the most statistically significant result in the whole dataset.</p>
<p>It was interesting to see the clear spikes in average reef bottom temperatures in August across all sites in 2015 and 2018, as it shows that our reef bottom temperature data reflects the natural phenomena discussed: 2015/2016 El Niño and the extreme warming of coastal temperatures in Southern California in 2018. All sites saw a decrease in average carapace length in August of 2015 from previous years, which may indicate that there were fewer individuals with larger carapace lengths at all sites when these warming events occurred.</p>
<p>Overall, the only site that I can make any sort of statistically grounded claim about is the Arroyo Quemado Reef, and even then, with the limited number of data points yielded when taking averages of carapace length and temperature in the month of August over a 10 year period, the final conclusion I have come to is that this subject demands further study and investigation. Science isn’t perfect, and we don’t always get statistically significant results. There is validity and truth in this fact, and protecting primary studies from the pressure to yield statistically significant results is essential, as results that are not statistically significant can still teach us about the population(s) we are trying to study.</p>
</section>
<section id="additional-considerations-possible-next-steps" class="level2">
<h2 class="anchored" data-anchor-id="additional-considerations-possible-next-steps">Additional Considerations &amp; Possible Next Steps</h2>
<p>Given more time and resources, there are a few elements of this analysis that I would change and several “next steps” that would be interesting to pursue.</p>
<p>As I have mentioned throughout this notebook, the limitations of the data at various steps proved challenging. I’ve already discussed the challenges of the September 2014 data, but I was also frustrated by the lack of temperature data for the Mohawk site in August of 2017. While I considered using functions like <code>na.approx</code> from the <code>zoo</code> package to make up for this, I ultimately ran out of time to fully achieve the outputs that would make including these steps worthwhile.</p>
<p>I also attempted to investigate the possible impact that MPA status (whether or not a site falls within a Marine Protected Area) had on the relationship between average August temperature and size, I also failed to get this code to yield any satisfactory outputs.</p>
</section>
<section id="sources" class="level2">
<h2 class="anchored" data-anchor-id="sources">Sources</h2>
<p>Bris, A. L., Pershing, A. J., Gaudette, J., Pugh, T. L., &amp; Reardon, K. M. (2017). <em>Multi-scale quantification of the effects of temperature on size at maturity in the American lobster (Homarus americanus)</em>. Fisheries Research, 186, 397-406. doi:10.1016/j.fishres.2016.09.008</p>
<p>Barnard, P. L., Hoover, D., Hubbard, D. M., Snyder, A., Ludka, B. C., Allan, J., Kaminsky, G. M., Ruggiero, P., Gallien, T. W., Gabel, L., McCandless, D., Weiner, H. M., Cohn, N., Anderson, D. L., &amp; Serafin, K. A. (2017). Extreme oceanographic forcing and coastal response due to the 2015–2016 El Niño. <em>Nature Communications</em>, <em>8</em>(1), Article 1. <a href="https://doi.org/10.1038/ncomms14365" class="uri">https://doi.org/10.1038/ncomms14365</a></p>
<p>California Coastal Commission. (2019). <em>Extreme Weather: El Niño</em>. (n.d.). Retrieved December 11, 2023, from <a href="https://www.coastal.ca.gov/climate/extreme-weather/el-nino/" class="uri">https://www.coastal.ca.gov/climate/extreme-weather/el-nino/</a></p>
<p><em>CA Marine Species Portal</em>. (n.d.). Retrieved December 11, 2023, from <a href="https://marinespecies.wildlife.ca.gov/california-spiny-lobster/the-species/" class="uri">https://marinespecies.wildlife.ca.gov/california-spiny-lobster/the-species/</a></p>
<p><em>California Spiny Lobster | California Sea Grant</em>. (n.d.). Retrieved December 12, 2023, from <a href="https://caseagrant.ucsd.edu/seafood-profiles/california-spiny-lobster" class="uri">https://caseagrant.ucsd.edu/seafood-profiles/california-spiny-lobster</a></p>
<p><em>California spiny lobster takes double hit from China market</em>. (n.d.). Retrieved December 14, 2023, from <a href="https://www.nationalfisherman.com/west-coast-pacific/california-spiny-lobster-takes-double-hit-from-china-market" class="uri">https://www.nationalfisherman.com/west-coast-pacific/california-spiny-lobster-takes-double-hit-from-china-market</a></p>
<p>Carter, M. L., Flick, R. E., Terrill, E., Beckhaus, E. C., Martin, K., Fey, C. L., Walker, P. W., Largier, J. L., &amp; McGowan, J. A. (2022). <em>Shore Stations Program Data Archive: Current and historical coastal ocean temperature and salinity measurements from California stations</em>. UC San Diego Library Digital Collections. <a href="https://doi.org/10.6075/J0S75GHD" class="uri">https://doi.org/10.6075/J0S75GHD</a> (Accessed 2023-12-12)</p>
<p>Castelao, R. M., &amp; Wang, Y. (2014). Wind-driven variability in sea surface temperature front distribution in the California Current System. <em>Journal of Geophysical Research: Oceans</em>, <em>119</em>(3), 1861–1875. <a href="https://doi.org/10.1002/2013JC009531" class="uri">https://doi.org/10.1002/2013JC009531</a></p>
<p>Day, P. B., Stuart-Smith, R. D., Edgar, G. J., &amp; Bates, A. E. (2018). Species’ thermal ranges predict changes in reef fish community structure during 8 years of extreme temperature variation. <em>Diversity and Distributions</em>, <em>24</em>(8), 1036–1046. <a href="https://doi.org/10.1111/ddi.12753" class="uri">https://doi.org/10.1111/ddi.12753</a></p>
<p>Ellertson, A. A., Waller, J. D., Pugh, T. L., &amp; Bethoney, N. D. (2022). Differences in the size at maturity of female American lobsters (Homarus americanus) from offshore Southern New England and eastern Georges Bank, USA. <em>Fisheries Research</em>, <em>250</em>, 106276. <a href="https://doi.org/10.1016/j.fishres.2022.106276" class="uri">https://doi.org/10.1016/j.fishres.2022.106276</a></p>
<p>Greenhalgh, E. (2016, October 6). <em>Climate &amp; Lobsters</em>. NOAA Climate.gov. <a href="http://www.climate.gov/news-features/climate-and/climate-lobsters" class="uri">http://www.climate.gov/news-features/climate-and/climate-lobsters</a></p>
<p>Greenhalgh, E. (2016, December 22). <em>Warming ocean temperatures push lobster populations north</em>. NOAA Climate.gov. <a href="http://www.climate.gov/news-features/featured-images/warming-ocean-temperatures-push-lobster-populations-north" class="uri">http://www.climate.gov/news-features/featured-images/warming-ocean-temperatures-push-lobster-populations-north</a></p>
<p><em>Gulf of Maine Warming Update: Summer 2021</em>. (2021, October 26). Gulf Of Maine Research Institute. <a href="https://www.gmri.org/stories/gulf-of-maine-warming-update-summer-2021/" class="uri">https://www.gmri.org/stories/gulf-of-maine-warming-update-summer-2021/</a></p>
<p>Ishaq, S. L., Turner, S. M., Lee, G., Tudor, M. S., MacRae, J. D., Hamlin, H., &amp; Bouchard, D. (2023). Water temperature and disease alters bacterial diversity and cultivability from American lobster (Homarus americanus) shells. <em>iScience</em>, <em>26</em>(5), 106606. <a href="https://doi.org/10.1016/j.isci.2023.106606" class="uri">https://doi.org/10.1016/j.isci.2023.106606</a></p>
<p>Koenig, E. &amp; American Geophysical Union. (2018, January 23). <em>American lobsters feeling the heat in the northwest Atlantic</em>. Phys.Org. <a href="https://phys.org/news/2018-01-american-lobsters-northwest-atlantic.html" class="uri">https://phys.org/news/2018-01-american-lobsters-northwest-atlantic.html</a></p>
<p>Lowder, K. B., deVries, M. S., Hattingh, R., Day, J. M. D., Andersson, A. J., Zerofski, P. J., &amp; Taylor, J. R. A. (2022). Exoskeletal predator defenses of juvenile California spiny lobsters (Panulirus interruptus) are affected by fluctuating ocean acidification-like conditions. <em>Frontiers in Marine Science</em>, <em>9</em>. <a href="https://www.frontiersin.org/articles/10.3389/fmars.2022.909017" class="uri">https://www.frontiersin.org/articles/10.3389/fmars.2022.909017</a></p>
<p>Mendelssohn, R., Schwing, F. B., &amp; Bograd, S. J. (2004). Nonstationary seasonality of upper ocean temperature in the California Current. <em>Journal of Geophysical Research: Oceans</em>, <em>109</em>(C10). <a href="https://doi.org/10.1029/2004JC002330" class="uri">https://doi.org/10.1029/2004JC002330</a></p>
<p>Monroe, R. (2018, August 2). <em>Highest-Ever Seawater Temperature Recorded at Scripps Pier | Scripps Institution of Oceanography</em>. <a href="https://scripps.ucsd.edu/news/highest-ever-seawater-temperature-recorded-scripps-pier" class="uri">https://scripps.ucsd.edu/news/highest-ever-seawater-temperature-recorded-scripps-pier</a></p>
<p>Neath, A. (2023, November 21). <em>Meet Bowie: The multi-colour, multi-gender lobster</em>. The Independent. <a href="https://www.independent.co.uk/news/world/americas/lobster-half-blue-maine-tiktok-bowie-b2450916.html" class="uri">https://www.independent.co.uk/news/world/americas/lobster-half-blue-maine-tiktok-bowie-b2450916.html</a></p>
<p>Oppenheim, N. G., Wahle, R. A., Brady, D. C., Goode, A. G., &amp; Pershing, A. J. (2019). The cresting wave: Larval settlement and ocean temperatures predict change in the American lobster harvest. <em>Ecological Applications</em>, <em>29</em>(8), e02006. <a href="https://doi.org/10.1002/eap.2006" class="uri">https://doi.org/10.1002/eap.2006</a></p>
<p>Paek, H., Yu, J.-Y., &amp; Qian, C. (2017). Why were the 2015/2016 and 1997/1998 extreme El Niños different? <em>Geophysical Research Letters</em>, <em>44</em>(4), 1848–1856. <a href="https://doi.org/10.1002/2016GL071515" class="uri">https://doi.org/10.1002/2016GL071515</a></p>
<p>Pershing, A. J., Alexander, M. A., Hernandez, C. M., Kerr, L. A., Le Bris, A., Mills, K. E., Nye, J. A., Record, N. R., Scannell, H. A., Scott, J. D., Sherwood, G. D., &amp; Thomas, A. C. (2015). Slow adaptation in the face of rapid warming leads to collapse of the Gulf of Maine cod fishery. <em>Science</em>, <em>350</em>(6262), 809–812. <a href="https://doi.org/10.1126/science.aac9819" class="uri">https://doi.org/10.1126/science.aac9819</a></p>
<p>Quinn, B. K., &amp; Rochette, R. (2015). Potential effect of variation in water temperature on development time of American lobster larvae. <em>ICES Journal of Marine Science</em>, <em>72</em>(suppl_1), i79–i90. <a href="https://doi.org/10.1093/icesjms/fsv010" class="uri">https://doi.org/10.1093/icesjms/fsv010</a></p>
<p><em>Record Warm Waters off Southern California</em>. (2018, August 8). [Text Article]. NASA Earth Observatory. <a href="https://earthobservatory.nasa.gov/images/92563/record-warm-waters-off-southern-california" class="uri">https://earthobservatory.nasa.gov/images/92563/record-warm-waters-off-southern-california</a></p>
<p>Reed, D. &amp; Miller, R. (2023). <em>SBC LTER: Reef: Abundance, size and fishing effort for California Spiny Lobster (Panulirus interruptus), ongoing since 2012 ver 9</em>. [Data File]. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/3595322687af94cd532620ad9db94c77" class="uri">https://doi.org/10.6073/pasta/3595322687af94cd532620ad9db94c77</a> (Accessed 2023-11-22).</p>
<p>Reed, D. &amp; Miller, R. (2023). <em>SBC LTER: Reef: Bottom Temperature: Continuous water temperature, ongoing since 2000 ver 29</em>. [Data File]. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/3071d4179516b5ae56018bfa03fea9dd" class="uri">https://doi.org/10.6073/pasta/3071d4179516b5ae56018bfa03fea9dd</a> (Accessed 2023-12-03).</p>
<p>Rheuban, J. E., Kavanaugh, M. T., &amp; Doney, S. C. (2017). Implications of Future Northwest Atlantic Bottom Temperatures on the American Lobster (Homarus americanus) Fishery. <em>Journal of Geophysical Research: Oceans</em>, <em>122</em>(12), 9387–9398. <a href="https://doi.org/10.1002/2017JC012949" class="uri">https://doi.org/10.1002/2017JC012949</a></p>
<p><em>Sea bottom temperature (SBT) Modeling</em>. (n.d.). Florida Fish And Wildlife Conservation Commission. Retrieved December 11, 2023, from <a href="https://myfwc.com/research/gis/fisheries/sbt/" class="uri">https://myfwc.com/research/gis/fisheries/sbt/</a></p>
<p>Stancioff, E. (2016, March 28). <em>A Maine lobster fishing community confronts their changing climate</em>. NOAA Climate.gov. <a href="http://www.climate.gov/news-features/climate-case-studies/maine-lobster-fishing-community-confronts-their-changing-climate" class="uri">http://www.climate.gov/news-features/climate-case-studies/maine-lobster-fishing-community-confronts-their-changing-climate</a></p>
<p>Tanaka, K. (n.d.). Research Highlights: New England Lobster in a Changing Climate: Development of a Forecasting Tool for Habitat Suitability - Maine Climate Office News - University of Maine Cooperative Extension. <em>Maine Climate Office News. The University of Maine</em>. Retrieved December 13, 2023, from <a href="https://extension.umaine.edu/maineclimatenews/archives/fall-2014/new-england-lobster-in-changing-climate/" class="uri">https://extension.umaine.edu/maineclimatenews/archives/fall-2014/new-england-lobster-in-changing-climate/</a></p>
<p>Zacharias, M., &amp; Kushner, D. (2006). Sea temperature and wave height as predictors of population size structure and density of Megastraea (Lithopoma) Undosa: Implications for fishery management. <em>Bulletin of Marine Science</em>, <em>79</em>, 71–82.</p>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Stancioff, E. (2016, March 28). <em>A Maine lobster fishing community confronts their changing climate</em>. NOAA Climate.gov. <a href="http://www.climate.gov/news-features/climate-case-studies/maine-lobster-fishing-community-confronts-their-changing-climate" class="uri">http://www.climate.gov/news-features/climate-case-studies/maine-lobster-fishing-community-confronts-their-changing-climate</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Greenhalgh, E. (2016, October 6). <em>Climate &amp; Lobsters</em>. NOAA Climate.gov. <a href="http://www.climate.gov/news-features/climate-and/climate-lobsters" class="uri">http://www.climate.gov/news-features/climate-and/climate-lobsters</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Rheuban, J. E., Kavanaugh, M. T., &amp; Doney, S. C. (2017). Implications of Future Northwest Atlantic Bottom Temperatures on the American Lobster (Homarus americanus) Fishery. <em>Journal of Geophysical Research: Oceans</em>, <em>122</em>(12), 9387–9398. <a href="https://doi.org/10.1002/2017JC012949" class="uri">https://doi.org/10.1002/2017JC012949</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Pershing, A. J., Alexander, M. A., Hernandez, C. M., Kerr, L. A., Le Bris, A., Mills, K. E., Nye, J. A., Record, N. R., Scannell, H. A., Scott, J. D., Sherwood, G. D., &amp; Thomas, A. C. (2015). Slow adaptation in the face of rapid warming leads to collapse of the Gulf of Maine cod fishery. <em>Science</em>, <em>350</em>(6262), 809–812. <a href="https://doi.org/10.1126/science.aac9819" class="uri">https://doi.org/10.1126/science.aac9819</a><a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Quinn, B. K., &amp; Rochette, R. (2015). Potential effect of variation in water temperature on development time of American lobster larvae. <em>ICES Journal of Marine Science</em>, <em>72</em>(suppl_1), i79–i90. <a href="https://doi.org/10.1093/icesjms/fsv010" class="uri">https://doi.org/10.1093/icesjms/fsv010</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Ellertson, A. A., Waller, J. D., Pugh, T. L., &amp; Bethoney, N. D. (2022). Differences in the size at maturity of female American lobsters (Homarus americanus) from offshore Southern New England and eastern Georges Bank, USA. <em>Fisheries Research</em>, <em>250</em>, 106276. <a href="https://doi.org/10.1016/j.fishres.2022.106276" class="uri">https://doi.org/10.1016/j.fishres.2022.106276</a><a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Ishaq, S. L., Turner, S. M., Lee, G., Tudor, M. S., MacRae, J. D., Hamlin, H., &amp; Bouchard, D. (2023). Water temperature and disease alters bacterial diversity and cultivability from American lobster (Homarus americanus) shells. <em>iScience</em>, <em>26</em>(5), 106606. <a href="https://doi.org/10.1016/j.isci.2023.106606" class="uri">https://doi.org/10.1016/j.isci.2023.106606</a><a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Rheuban, J. E., Kavanaugh, M. T., &amp; Doney, S. C. (2017). Implications of Future Northwest Atlantic Bottom Temperatures on the American Lobster (Homarus americanus) Fishery. <em>Journal of Geophysical Research: Oceans</em>, <em>122</em>(12), 9387–9398. <a href="https://doi.org/10.1002/2017JC012949" class="uri">https://doi.org/10.1002/2017JC012949</a><a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p><em>Gulf of Maine Warming Update: Summer 2021</em>. (2021, October 26). Gulf Of Maine Research Institute. <a href="https://www.gmri.org/stories/gulf-of-maine-warming-update-summer-2021/" class="uri">https://www.gmri.org/stories/gulf-of-maine-warming-update-summer-2021/</a><a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>California Department of Fish and Wildlife. (2019). California Spiny Lobster, <em>Panulirus interruptus</em>, Enhanced Status Report.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>California Department of Fish and Wildlife. (2019). California Spiny Lobster, <em>Panulirus interruptus</em>, Enhanced Status Report.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>California Department of Fish and Wildlife. (2019). California Spiny Lobster, <em>Panulirus interruptus</em>, Enhanced Status Report.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>Engle J. M. (1979). Ecology and growth of juvenile California spiny lobster, <em>Panulirus interruptus</em> (Randall) (Los Angeles, California, United States: University of Southern California).<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn14"><p>California Department of Fish and Wildlife. (2019). California Spiny Lobster, <em>Panulirus interruptus</em>, Enhanced Status Report.<a href="#fnref14" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn15"><p>Barnard, P., Hoover, D., Hubbard, D. et al.&nbsp;(2017). <em>Extreme oceanographic forcing and coastal response due to the 2015–2016 El Niño</em>. Nat Commun 8, 14365. <a href="https://doi.org/10.1038/ncomms14365" class="uri">https://doi.org/10.1038/ncomms14365</a><a href="#fnref15" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn16"><p>Mendelssohn, R., Schwing, F. B., &amp; Bograd, S. J. (2004). Nonstationary seasonality of upper ocean temperature in the California Current. <em>Journal of Geophysical Research: Oceans</em>, <em>109</em>(C10). <a href="https://doi.org/10.1029/2004JC002330" class="uri">https://doi.org/10.1029/2004JC002330</a><a href="#fnref16" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn17"><p>Castelao, R. M., &amp; Wang, Y. (2014). Wind-driven variability in sea surface temperature front distribution in the California Current System. <em>Journal of Geophysical Research: Oceans</em>, <em>119</em>(3), 1861–1875. <a href="https://doi.org/10.1002/2013JC009531" class="uri">https://doi.org/10.1002/2013JC009531</a><a href="#fnref17" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn18"><p>California Department of Fish and Wildlife. (2019). California Spiny Lobster, <em>Panulirus interruptus</em>, Enhanced Status Report.<a href="#fnref18" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn19"><p>Engle J. M. (1979). Ecology and growth of juvenile California spiny lobster, <em>Panulirus interruptus</em> (Randall) (Los Angeles, California, United States: University of Southern California).<a href="#fnref19" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn20"><p>California Department of Fish and Wildlife. (2019). California Spiny Lobster, <em>Panulirus interruptus</em>, Enhanced Status Report.<a href="#fnref20" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn21"><p>Barnard, P. L., Hoover, D., Hubbard, D. M., Snyder, A., Ludka, B. C., Allan, J., Kaminsky, G. M., Ruggiero, P., Gallien, T. W., Gabel, L., McCandless, D., Weiner, H. M., Cohn, N., Anderson, D. L., &amp; Serafin, K. A. (2017). Extreme oceanographic forcing and coastal response due to the 2015–2016 El Niño. <em>Nature Communications</em>, <em>8</em>(1), Article 1. <a href="https://doi.org/10.1038/ncomms14365" class="uri">https://doi.org/10.1038/ncomms14365</a><a href="#fnref21" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn22"><p><em>Sea bottom temperature (SBT) Modeling</em>. (n.d.). Florida Fish And Wildlife Conservation Commission. Retrieved December 11, 2023, from <a href="https://myfwc.com/research/gis/fisheries/sbt/" class="uri">https://myfwc.com/research/gis/fisheries/sbt/</a><a href="#fnref22" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn23"><p><em>Record Warm Waters off Southern California</em>. (2018, August 8). [Text Article]. NASA Earth Observatory. <a href="https://earthobservatory.nasa.gov/images/92563/record-warm-waters-off-southern-california" class="uri">https://earthobservatory.nasa.gov/images/92563/record-warm-waters-off-southern-california</a><a href="#fnref23" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn24"><p>Monroe, R. (2018, August 2). <em>Highest-Ever Seawater Temperature Recorded at Scripps Pier | Scripps Institution of Oceanography</em>. <a href="https://scripps.ucsd.edu/news/highest-ever-seawater-temperature-recorded-scripps-pier" class="uri">https://scripps.ucsd.edu/news/highest-ever-seawater-temperature-recorded-scripps-pier</a><a href="#fnref24" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{ramji2023,
  author = {Ramji, Anna},
  title = {California {Spiny} {Lobsters} \&amp; {Reef} {Bottom}
    {Temperatures}},
  date = {2023-12-17},
  url = {https://annaramji.github.io/blog/2023-12-17-ca-spiny-lobsters/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-ramji2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Ramji, Anna. 2023. <span>“California Spiny Lobsters &amp; Reef Bottom
Temperatures.”</span> December 17, 2023. <a href="https://annaramji.github.io/blog/2023-12-17-ca-spiny-lobsters/">https://annaramji.github.io/blog/2023-12-17-ca-spiny-lobsters/</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2024, Anna Ramji</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/annaramji">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>